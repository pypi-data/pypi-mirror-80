const m={};import U from"../__snowpack__/env.js";m.env=U;import e,{Suspense as w,useCallback as j,useEffect as a,useMemo as v,useState as b}from"../web_modules/react.js";import{Redirect as y,Route as c,BrowserRouter as C,Switch as A,useLocation as B}from"../web_modules/react-router-dom.js";import{THEME as L,matchMedia as u}from"./utils/theme.js";import{headerHeight as d,position as N,size as T}from"./utils/style.js";import x from"./components/BodyLoading.js";import S from"./components/ErrorBoundary.js";import p from"./pages/error.js";import{Helmet as I}from"../web_modules/react-helmet.js";import E from"../web_modules/nprogress.js";import k from"./components/Navbar.js";import{SWRConfig as H}from"../web_modules/swr.js";import{ToastContainer as M}from"../web_modules/react-toastify.js";import{actions as O}from"./store/index.js";import{fetcher as W}from"./utils/fetch.js";import D from"../web_modules/@visualdl/wasm.js";import f from"./routes/index.js";import h from"../web_modules/styled-components.js";import{useDispatch as K}from"../web_modules/react-redux.js";import{useTranslation as V}from"../web_modules/react-i18next.js";const P=m.env.SNOWPACK_PUBLIC_BASE_URI,z=m.env.SNOWPACK_PUBLIC_PATH,$=h.main.withConfig({displayName:"App__Main",componentId:"n063fb-0"})(["padding-top:",";"],d),F=h.header.withConfig({displayName:"App__Header",componentId:"n063fb-1"})(["z-index:10000;"," ",""],T(d,"100%"),N("fixed",0,0,null,0)),l=f.find(t=>t.default),q=f.reduce((t,r)=>(r.children?t.push(...r.children):t.push(r),t),[]),G=()=>(a(()=>(E.start(),()=>{E.done()}),[]),null),J=()=>{const t=B();return a(()=>{window._hmt.push(["_trackPageview",P+t.pathname])},[t.pathname]),null},Q=()=>{var t;const{t:r,i18n:o}=V("errors"),R=v(()=>o.language?o.dir(o.language):"",[o]),[s,g]=b(!1);a(()=>{(async()=>{s||(await D(`${z}/wasm/visualdl.wasm`),g(!0))})()},[s]);const i=K(),_=j(n=>i(O.theme.setTheme(n.matches?"dark":"light")),[i]);return a(()=>{if(!L)return u.addEventListener("change",_),()=>{u.removeEventListener("change",_)}},[_]),e.createElement("div",{className:"app"},e.createElement(I,{defaultTitle:"VisualDL",titleTemplate:"%s - VisualDL"},e.createElement("html",{lang:o.language,dir:R})),e.createElement(H,{value:{fetcher:W,revalidateOnFocus:!1,revalidateOnReconnect:!1}},s?e.createElement($,null,e.createElement(C,{basename:P||"/"},e.createElement(J,null),e.createElement(F,null,e.createElement(k,null)),e.createElement(S,{fallback:e.createElement(p,null)},e.createElement(w,{fallback:e.createElement(G,null)},e.createElement(A,null,e.createElement(y,{exact:!0,from:"/",to:(t=l==null?void 0:l.path)!==null&&t!==void 0?t:"/index"}),q.map(n=>e.createElement(c,{key:n.id,path:n.path,component:n.component})),e.createElement(c,{path:"*"},e.createElement(p,{title:r("errors:page-not-found")}))))))):e.createElement(x,null),e.createElement(M,null)))};export default Q;
