const W={};import F from"../../../__snowpack__/env.js";W.env=F;import i,{useCallback as T,useEffect as s,useImperativeHandle as M,useMemo as V,useRef as q,useState as C}from"../../../web_modules/react.js";import{contentHeight as J,position as O,primaryColor as Q,rem as a,size as x,transitionProps as H}from"../../utils/style.js";import X from"../ChartToolbox.js";import Y from"../../../web_modules/react-spinners/HashLoader.js";import Z from"../../assets/images/netron.png.proxy.js";import l from"../../../web_modules/styled-components.js";import{toast as D}from"../../../web_modules/react-toastify.js";import S from"../../hooks/useTheme.js";import{useTranslation as ee}from"../../../web_modules/react-i18next.js";const h=W.env.SNOWPACK_PUBLIC_PATH;let G=`${window.location.protocol}//${window.location.host}`;if(h.startsWith("http")){const r=new URL(h);G=`${r.protocol}//${r.host}`}const I=a(40),oe=l.div.withConfig({displayName:"Graph__Wrapper",componentId:"ojmbku-0"})(["position:relative;height:",";background-color:var(--background-color);display:flex;flex-direction:column;justify-content:center;align-items:center;",""],J,H("background-color")),te=l.div.withConfig({displayName:"Graph__RenderContent",componentId:"ojmbku-1"})(["position:absolute;top:0;left:0;"," opacity:",";z-index:",";pointer-events:",";"],x("100%","100%"),r=>r.show?1:0,r=>r.show?0:-1,r=>r.show?"auto":"none"),re=l(X).withConfig({displayName:"Graph__Toolbox",componentId:"ojmbku-2"})(["height:",";border-bottom:1px solid var(--border-color);padding:0 ",";",""],I,a(20),H("border-color")),ne=l.div.withConfig({displayName:"Graph__Content",componentId:"ojmbku-3"})(["position:relative;height:calc(100% - ",");> iframe{"," border:none;}> .powered-by{display:block;"," color:var(--graph-copyright-color);font-size:",";user-select:none;img{height:1em;filter:var(--graph-copyright-logo-filter);vertical-align:middle;}}"],I,x("100%","100%"),O("absolute",null,null,a(20),a(30)),a(14)),ie=l.div.withConfig({displayName:"Graph__Loading",componentId:"ojmbku-4"})([""," display:flex;flex-direction:column;justify-content:center;align-items:center;overscroll-behavior:none;cursor:progress;font-size:",";line-height:",";"],x("100%","100%"),a(16),a(60)),$=i.forwardRef(({files:r,uploader:j,showAttributes:k,showInitializers:R,showNames:z,horizontal:P,onRendered:c,onOpened:d,onSearch:m,onShowModelProperties:u,onShowNodeProperties:p,onShowNodeDocumentation:_},A)=>{const{t:f}=ee("graph"),U=S(),[o,N]=C(!1),[v,g]=C(!1),[b,B]=C(!1),L=q(null),y=T(t=>{if(t.data){const{type:w,data:n}=t.data;switch(w){case"status":switch(n){case"ready":return N(!0);case"loading":return g(!0);case"rendered":g(!1),B(!0),c==null||c();return}return;case"opened":return d==null?void 0:d(n);case"search":return m==null?void 0:m(n);case"cancel":return g(!1);case"error":D(n),g(!1);return;case"show-model-properties":return u==null?void 0:u(n);case"show-node-properties":return p==null?void 0:p(n);case"show-node-documentation":return _==null?void 0:_(n)}}},[c,d,m,u,p,_]),e=T((t,w)=>{var n,E;(n=L.current)===null||n===void 0||((E=n.contentWindow)===null||E===void 0)||E.postMessage({type:t,data:w},G)},[]);s(()=>(window.addEventListener("message",y),e("ready"),()=>{window.removeEventListener("message",y)}),[y,e]),s(()=>o&&e("change-files",r)||void 0,[e,r,o]),s(()=>o&&e("toggle-attributes",k)||void 0,[e,k,o]),s(()=>o&&e("toggle-initializers",R)||void 0,[e,R,o]),s(()=>o&&e("toggle-names",z)||void 0,[e,z,o]),s(()=>o&&e("toggle-direction",P)||void 0,[e,P,o]),s(()=>o&&e("toggle-theme",U)||void 0,[e,U,o]),M(A,()=>({export(t){e("export",t)},changeGraph(t){e("change-graph",t)},search(t){e("search",t)},select(t){e("select",t)},showModelProperties(){e("show-model-properties")},showNodeDocumentation(t){e("show-node-documentation",t)}}));const K=V(()=>!o||v?i.createElement(ie,null,i.createElement(Y,{size:"60px",color:Q})):o&&!b?j:null,[o,v,b,j]);return i.createElement(oe,null,K,i.createElement(te,{show:!v&&b},i.createElement(re,{items:[{icon:"zoom-in",tooltip:f("graph:zoom-in"),onClick:()=>e("zoom-in")},{icon:"zoom-out",tooltip:f("graph:zoom-out"),onClick:()=>e("zoom-out")},{icon:"restore-size",tooltip:f("graph:restore-size"),onClick:()=>e("zoom-reset")}],reversed:!0,tooltipPlacement:"bottom"}),i.createElement(ne,null,i.createElement("iframe",{ref:L,src:`${h}/netron/index.html`,frameBorder:0,scrolling:"no",marginWidth:0,marginHeight:0}),i.createElement("a",{className:"powered-by",href:"https://github.com/lutzroeder/netron",target:"_blank",rel:"noreferrer"},"Powered by ",i.createElement("img",{src:h+Z,alt:"netron"})))))});$.displayName="Graph";export default $;
