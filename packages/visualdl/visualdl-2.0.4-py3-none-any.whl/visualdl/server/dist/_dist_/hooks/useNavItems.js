function p(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),e.push.apply(e,n)}return e}function d(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?p(Object(e),!0).forEach(function(n){b(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):p(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}function b(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}import g,{Pages as s}from"../routes/index.js";import{useCallback as P,useEffect as m,useState as j}from"../../web_modules/react.js";import h from"../utils/event.js";import{fetcher as y}from"../utils/fetch.js";import I from"./useRequest.js";export const navMap={scalar:s.Scalar,histogram:s.Histogram,image:s.Image,audio:s.Audio,graph:s.Graph,embeddings:s.HighDimensional,pr_curve:s.PRCurve};const w=()=>{const[r,t]=j([]),{data:e,loading:n,error:u,mutate:a}=I("/components",y,{refreshInterval:r.length?61*1e3:15*1e3,dedupingInterval:14*1e3,errorRetryInterval:15*1e3,errorRetryCount:Number.POSITIVE_INFINITY,revalidateOnFocus:!0,revalidateOnReconnect:!0,refreshWhenHidden:!1,refreshWhenOffline:!1});m(()=>(h.on("refresh",a),()=>{h.off("refresh",a)}),[a]);const c=P(O=>{var f;const v=(f=e==null?void 0:e.map(i=>navMap[i]))!==null&&f!==void 0?f:[];return O.reduce((i,o)=>{if(o.children){const l=c(o.children);l.length&&i.push(d(d({},o),{},{children:l}))}else o.visible!==!1&&v.includes(o.id)&&i.push(o);return i},[])},[e]);return m(()=>{t(c(g))},[c]),[r,n,u]};export default w;
