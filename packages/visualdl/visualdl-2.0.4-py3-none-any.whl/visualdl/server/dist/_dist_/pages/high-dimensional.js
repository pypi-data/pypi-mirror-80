import Q,{AsideSection as E}from"../components/Aside.js";import e,{useEffect as z,useMemo as r,useState as s}from"../../web_modules/react.js";import M from"../components/Select.js";import{em as $,rem as y}from"../utils/style.js";import J from"../components/Checkbox.js";import K from"../components/Content.js";import O from"../components/Error.js";import p from"../components/Field.js";import W from"../components/HighDimensionalPage/HighDimensionalChart.js";import X from"../components/Icon.js";import T from"../components/RadioButton.js";import A from"../components/RadioGroup.js";import Y from"../components/RunningToggle.js";import Z from"../components/SearchInput.js";import ee from"../components/Title.js";import v from"../../web_modules/styled-components.js";import ne from"../hooks/useQuery.js";import{useRunningRequest as te}from"../hooks/useRequest.js";import oe from"../hooks/useSearchValue.js";import{useTranslation as le}from"../../web_modules/react-i18next.js";const D=["2d","3d"],V=["pca","tsne"],ie=v(M).withConfig({displayName:"high-dimensional__StyledSelect",componentId:"kunowy-0"})(["min-width:",";"],$(160)),x=v(X).withConfig({displayName:"high-dimensional__StyledIcon",componentId:"kunowy-1"})(["margin-right:",";vertical-align:middle;"],$(4)),j=v.div.withConfig({displayName:"high-dimensional__AsideTitle",componentId:"kunowy-2"})(["font-size:",";line-height:",";font-weight:700;margin-bottom:",";"],y(16),y(16),y(10)),re=()=>{const{t}=le(["high-dimensional","common"]),[_,S]=s(!0),{data:c,error:H,loading:g}=te("/embedding/tags",_),o=r(()=>c?c.runs.reduce((n,l,m)=>{var i,a;return[...n,...(i=(a=c.tags[m])===null||a===void 0?void 0:a.map(I=>({run:l,tag:I,label:`${l}/${I}`})))!==null&&i!==void 0?i:[]]},[]):[],[c]),h=r(()=>o.map(n=>n.label),[o]),u=ne(),R=r(()=>{var n,l,m;const i=Array.isArray(u.run)?u.run[0]:u.run;return(n=i&&((l=o.find(a=>a.run===i))===null||l===void 0?void 0:l.label))!==null&&n!==void 0?n:(m=o[0])===null||m===void 0?void 0:m.label},[u.run,o]),[d,C]=s(R);z(()=>C(R),[R]);const w=r(()=>{var n;return(n=o.find(l=>l.label===d))!==null&&n!==void 0?n:{run:"",tag:"",label:""}},[o,d]),[f,L]=s(""),q=oe(f),[P,F]=s(D[0]),[U,N]=s(V[0]),[b,B]=s(!0),k=r(()=>e.createElement(Y,{running:_,onToggle:S}),[_,S]),G=r(()=>h.length?e.createElement(Q,{bottom:k},e.createElement(E,null,e.createElement(j,null,t("common:select-runs")),e.createElement(ie,{list:h,value:d,onChange:C})),e.createElement(E,null,e.createElement(p,null,e.createElement(Z,{placeholder:t("common:search"),value:f,onChange:L})),e.createElement(p,null,e.createElement(J,{value:b,onChange:B},t("high-dimensional:display-all-label")))),e.createElement(E,null,e.createElement(j,null,e.createElement(x,{type:"dimension"}),t("high-dimensional:dimension")),e.createElement(p,null,e.createElement(A,{value:P,onChange:n=>F(n)},D.map(n=>e.createElement(T,{key:n,value:n},t(n)))))),e.createElement(E,null,e.createElement(j,null,e.createElement(x,{type:"reduction"}),t("high-dimensional:reduction-method")),e.createElement(p,null,e.createElement(A,{value:U,onChange:n=>N(n)},V.map(n=>e.createElement(T,{key:n,value:n},t(n))))))):null,[t,k,P,d,h,b,U,f]);return e.createElement(e.Fragment,null,e.createElement(ee,null,t("common:high-dimensional")),e.createElement(K,{aside:G,loading:g},!g&&!o.length?e.createElement(O,null):H?e.createElement("div",null,t("common:error")):g?null:e.createElement(W,{dimension:P,keyword:q,run:w.run,tag:w.tag,running:_,labelVisibility:b,reduction:U})))};export default re;
