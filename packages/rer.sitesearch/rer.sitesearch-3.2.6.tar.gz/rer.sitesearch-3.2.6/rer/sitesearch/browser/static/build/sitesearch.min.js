"use strict";require(["jquery"],function(u){var s,n,i,r,l;1===u("input#searchGadget").length?u("input#searchGadget").val(u("input#SearchableText").attr("value")):u("input#nolivesearchGadget").val(u("input#SearchableText").attr("value")),u.fn.pullSearchResults=function(h){return this.each(function(){var o=u(this),e=h+"&ajax_load=1";o.addClass("searchingLoader"),u.get("@@updated_search?"+e,function(e){o.hide(),0===u("#ajax-search-res").length&&u("body").append('<div id="ajax-search-res"></div>'),u("#ajax-search-res").html(e);var t=u("#ajax-search-res #search-results > *"),a=u("#ajax-search-res #updated-search-term input#SearchableText").attr("value"),r=u("#search-results-bar",e).html(),s=u("#search-results-text",e).html(),n=u("#ajax-search-res #updated-path-options").html(),i=u("#ajax-search-res #updated-sorting-options").html(),l=u("#ajax-search-res #updated-tab-options").html(),c=u("#ajax-search-res #updated-indexes-options").html();o.removeClass("searchingLoader"),o.html(t),o.fadeIn(),u("input#SearchableText").attr("value",a),1===u("input#searchGadget").length?u("input#searchGadget").val(a):u("input#nolivesearchGadget").val(a),u("#search-results-bar").html(r),u("#search-results-text").html(s),null===n&&u("#path-options").remove(),u("#sorting-options").html(i),u("#tab-options").html(l),u("#indexes-options").html(c),null===c?u("#indexes-options").hide():u("#indexes-options").show(),u("#ajax-search-res").empty(),u("#rss-subscription a.link-feed").attr("href",function(){var e=u("body").data("portal-url");return(u("meta[name=navigation_root_url]").attr("content")||window.navigation_root_url||e)+"/search_rss?"+h}),d()})})},i=function(){return u("form.searchPage").serialize()},n=function(e){var t=u("body").data("portal-url"),a=(u("meta[name=navigation_root_url]").attr("content")||window.navigation_root_url||t)+"/@@search?"+e;history.pushState(null,null,a)},r="state"in window.history,l=location.href,u(window).bind("popstate",function(e){var t,a;t=!r&&location.href===l,r=!0,t||location.search&&(a=(a=(s=location.search.split("?")[1]).match(/SearchableText=[^&]*/)[0]).replace(/\+/g," "),u('#search-field input[name="SearchableText"], input#searchGadget').val(a.substr(15,a.length)),u("#search-results").pullSearchResults(s))}),u('#search-filter input.searchPage[type="submit"]').hide(),u("#search-field input.searchButton").click(function(e){var t,a={};t=u('#search-field input[name="SearchableText"]').val(),a.SearchableText=t,u("#search-results").pullSearchResults(a),n(a),e.preventDefault()}),u("form.searchPage").submit(function(e){var t,a={};t=u('#search-field input[name="SearchableText"]').val(),a.SearchableText=t,u("#search-results").pullSearchResults(a),n(a),e.preventDefault()}),u('#search-field input[name="SearchableText"]').keyup(function(){1===u("input#searchGadget").length?u("input#searchGadget").val(u(this).val()):u("input#nolivesearchGadget").val(u(this).val())}),u("#search-results-bar dl.actionMenu > dd.actionMenuContent").click(function(e){e.stopImmediatePropagation()}),u(document).on("change","#search-filter .field input, #search-filter select",function(e){s=i(),u("#search-results").pullSearchResults(s),n(s),e.preventDefault()}),u(document).on("click","#sorting-options a",function(e){u(this).attr("data-sort")?u("form.searchPage input[name='sort_on']").val(u(this).attr("data-sort")):u("form.searchPage input[name='sort_on']").val(""),u(this).attr("data-sort_order")?u("form.searchPage input[name='sort_order']").val(u(this).attr("data-sort_order")):u("form.searchPage input[name='sort_order']").val(""),s=i(),u("#search-results").pullSearchResults(s),n(s),e.preventDefault()}),u(document).on("click","#search-results nav.pagination a",function(e){e.preventDefault();var t=this.search.split("?")[1],a="",r="b_start:int=";0<t.length&&(a=t.split("&").reduce(function(e,t){return 0===t.indexOf(r)?t.substr(r.length):e},0)),s=i(),a.length&&(s+="&b_start:int="+parseInt(a,10)),u("#search-results").pullSearchResults(s),n(s)}),u(document).on("click","#tab-options a",function(e){e.preventDefault(),u(this).attr("data-tab")?u("form.searchPage input[name='filter_tab']").val(u(this).attr("data-tab")):u("form.searchPage input[name='filter_tab']").val("all"),s=i(),u("#search-results").pullSearchResults(s),n(s)}),u(document).on("click","a.linkRemoveFilters",function(e){u(this).parent().find("input:checked").each(function(){u(this).attr("checked",!1)}),0<=u(this).attr("class").indexOf("linkRemoveFilters")&&u(this).parent().remove(),s=i(),u("#search-results").pullSearchResults(s),n(s),e.preventDefault()});var c=u('<img src="/++plone++rer.sitesearch/images/loader.gif">');function d(){u("a.more_like_this").each(function(e,t){var a=u(t),r=a.parents(".solr_result_item"),s=u(this).attr("href");u(t).click(function(e){u(".solr_result_item .solrMLTPlaceHolder").fadeOut(500).html("").show(),u(".solr_result_item .solrMLTHideTarget:hidden").show(),u("a.more_like_this:hidden").show();var t=c.clone();a.append(t),e.preventDefault(),u.ajax({url:s,data:{ajax_include_head:"1",ajax_load:"1"},success:function(e){r.find(".solrMLTHideTarget").hide(),r.find(".solrMLTPlaceHolder").hide().html(u("#content-more-like-this",e).html()).fadeIn(500),t.remove(),a.hide()},error:function(){t.remove()}})})})}u(document).ready(d),u(document).on("click","#search-filter button.refineSearch",function(){u("#search-results-wrapper .search-filters").slideToggle("fast"),u("#search-filter button.refineSearch").toggleClass("open"),u("#search-filter button.refineSearch").attr("aria-expanded","false"===u("#search-filter button.refineSearch").attr("aria-expanded"))})}),define("rer/sitesearch/browser/static/sitesearch.js",function(){});
//# sourceMappingURL=sitesearch-compiled.js.map