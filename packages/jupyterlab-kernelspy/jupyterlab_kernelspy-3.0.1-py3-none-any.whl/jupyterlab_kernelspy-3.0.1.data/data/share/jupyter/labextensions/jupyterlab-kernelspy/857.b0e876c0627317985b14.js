(self.webpackChunkjupyterlab_kernelspy=self.webpackChunkjupyterlab_kernelspy||[]).push([[857],{857:(e,t,n)=>{"use strict";n.r(t),n.d(t,{IKernelSpyExtension:()=>j,KernelSpyExtension:()=>E,default:()=>w});var r=n(261),o=n(297),s=n(723),a=n(961),l=n(661),i=n(850),d=n(828),c=n(797),p=n(916),h=n(418),u=n(129),m=n(562);class g{constructor(e,t){this._threads=e,this._collapsed=t,this._index=-1,this._child=null}iter(){return this}next(){if(this._child){let e=this._child.next();if(void 0!==e)return e;this._child=null}if(++this._index,this._index>=this._threads.length)return;const e=this._threads[this._index];return e.children.length>0&&!this._collapsed[e.args.msg.header.msg_id]&&(this._child=new g(e.children,this._collapsed)),{args:e.args,hasChildren:e.children.length>0}}clone(){let e=new g(this._threads,this._collapsed);return e._index=this._index,this._child&&(e._child=this._child.clone()),e}}class _ extends o.VDomModel{constructor(e){super(),this._log=[],this._kernel=null,this._messages={},this._childLUT={},this._roots=[],this.kernel=null!=e?e:null}clear(){this._log.splice(0,this._log.length),this._messages={},this._childLUT={},this._roots=[],this.stateChanged.emit(void 0)}get kernel(){return this._kernel}set kernel(e){this._kernel&&this._kernel.anyMessage.disconnect(this.onMessage,this),this._kernel=e,this._kernel&&this._kernel.anyMessage.connect(this.onMessage,this)}get log(){return this._log}get tree(){return this._roots.map(e=>this.getThread(e,!1))}depth(e){if(null===e)return-1;let t=0;for(;e=this._findParent(e);)++t;return t}getThread(e,t=!0){const n=this._messages[e];if(t){let e,t=n;for(;e=this._findParent(t);)t=e;return this.getThread(t.msg.header.msg_id,!1)}let r=(this._childLUT[e]||[]).map(e=>this.getThread(e,!1));return{args:this._messages[e],children:r}}onMessage(e,t){const{msg:n}=t;this._log.push(t),this._messages[n.header.msg_id]=t;const r=this._findParent(t);if(null===r)this._roots.push(n.header.msg_id);else{const e=r.msg.header;this._childLUT[e.msg_id]=this._childLUT[e.msg_id]||[],this._childLUT[e.msg_id].push(n.header.msg_id)}this.stateChanged.emit(void 0)}_findParent(e){return void 0!==e.msg.parent_header.msg_id&&this._messages[e.msg.parent_header.msg_id]||null}}n(549);const f={BASE_FONT_FAMILY:"var(--jp-code-font-family)",BASE_FONT_SIZE:"var(--jp-code-font-size)",BASE_LINE_HEIGHT:"var(--jp-code-line-height)",BASE_BACKGROUND_COLOR:"var(--jp-layout-color0)",BASE_COLOR:"var(--jp-content-font-color1)",OBJECT_NAME_COLOR:"var(--jp-mirror-editor-attribute-color)",OBJECT_VALUE_NULL_COLOR:"var(--jp-mirror-editor-builtin-color)",OBJECT_VALUE_UNDEFINED_COLOR:"var(--jp-mirror-editor-builtin-color)",OBJECT_VALUE_REGEXP_COLOR:"var(--jp-mirror-editor-string-color)",OBJECT_VALUE_STRING_COLOR:"var(--jp-mirror-editor-string-color)",OBJECT_VALUE_SYMBOL_COLOR:"var(--jp-mirror-editor-operator-color)",OBJECT_VALUE_NUMBER_COLOR:"var(--jp-mirror-editor-number-color)",OBJECT_VALUE_BOOLEAN_COLOR:"var(--jp-mirror-editor-builtin-color))",OBJECT_VALUE_FUNCTION_KEYWORD_COLOR:"var(--jp-mirror-editor-def-color))",ARROW_COLOR:"var(--jp-content-font-color2)",ARROW_MARGIN_RIGHT:3,ARROW_FONT_SIZE:12,TREENODE_FONT_FAMILY:"var(--jp-code-font-family)",TREENODE_FONT_SIZE:"var(--jp-code-font-size)",TREENODE_LINE_HEIGHT:"var(--jp-code-line-height)",TREENODE_PADDING_LEFT:12};function v(e){const{name:t,depth:n,isNonenumerable:o,data:s}=e;if(0!==n)return r.createElement(h.ObjectLabel,{key:"node-label",name:t,data:s,isNonenumerable:o});const a=s;return r.createElement("span",{key:"node-label"},a.header.msg_id)}class y extends o.VDomRenderer{constructor(e){super(e),this.collapsed={},this.id="kernelspy-messagelog-"+c.UUID.uuid4(),this.addClass("jp-kernelspy-messagelog")}render(){const e=this.model,t=[];t.push(r.createElement("span",{key:"header-thread",className:"jp-kernelspy-logheader"},"Threads"),r.createElement("span",{key:"header-contents",className:"jp-kernelspy-logheader"},"Contents"),r.createElement("span",{key:"header-divider",className:"jp-kernelspy-logheader jp-kernelspy-divider"}));let n=new g(e.tree,this.collapsed),o=!0;return(0,i.each)(n,({args:n,hasChildren:s})=>{const l=e.depth(n);0===l&&(o?o=!1:t.push(r.createElement("span",{key:"'divider-"+n.msg.header.msg_id,className:"jp-kernelspy-divider"})));const i=this.collapsed[n.msg.header.msg_id];t.push(...function(e){const t=e.message,n=t.header.msg_id,o=e.collapsed?"jp-mod-collapsed":"",s=e.hasChildren?e.collapsed?a.caretRightIcon:a.caretDownIcon:null,l=e.hasChildren?"jp-mod-children":"",i=e.hasChildren?0:-1;return[r.createElement("div",{key:"threadnode-"+n,className:"jp-kernelspy-threadnode",onClick:()=>{e.onCollapse(e.message)}},r.createElement("div",{style:{paddingLeft:16*e.depth}},r.createElement("button",{className:`jp-kernelspy-threadcollapser ${o} ${l}`,tabIndex:i},s&&r.createElement(s.react,{className:"kspy-collapser-icon"})),r.createElement("span",{className:"jp-kernelspy-threadlabel"},t.channel,".",t.header.msg_type))),r.createElement("div",{key:"message-"+n,className:"jp-kernelspy-message"},r.createElement(h.ObjectInspector,{data:t,theme:f,nodeRenderer:v}))]}({message:n.msg,depth:l,collapsed:i,hasChildren:s,onCollapse:e=>{this.onCollapse(e)}}))}),t}collapseAll(){for(let e of this.model.log)this.collapsed[e.msg.header.msg_id]=!0;this.update()}expandAll(){this.collapsed={},this.update()}onCollapse(e){const t=e.header.msg_id;this.collapsed[t]=!this.collapsed[t],this.update()}}class b extends p.Widget{constructor(e){super(),this._model=new _(e),this.addClass("jp-kernelspy-view"),this.id="kernelspy-"+c.UUID.uuid4(),this.title.label="Kernel spy",this.title.closable=!0,this.title.iconRenderer=a.jsonIcon;let t=this.layout=new p.BoxLayout;this._toolbar=new o.Toolbar,this._toolbar.addClass("jp-kernelspy-toolbar"),this._messagelog=new y(this._model),t.addWidget(this._toolbar),t.addWidget(this._messagelog),p.BoxLayout.setStretch(this._toolbar,0),p.BoxLayout.setStretch(this._messagelog,1),this.collapseAllButton=new o.ToolbarButton({onClick:()=>{this._messagelog.collapseAll()},className:"jp-kernelspy-collapseAll",icon:a.caretRightIcon,tooltip:"Collapse all threads"}),this._toolbar.addItem("collapse-all",this.collapseAllButton),this.expandAllButton=new o.ToolbarButton({onClick:()=>{this._messagelog.expandAll()},className:"jp-kernelspy-expandAll",icon:a.caretDownIcon,tooltip:"Expand all threads"}),this._toolbar.addItem("expand-all",this.expandAllButton),this.clearAllButton=new o.ToolbarButton({onClick:()=>{this._model.clear()},className:"jp-kernelspy-clearAll",icon:a.closeIcon,tooltip:"Clear all threads"}),this._toolbar.addItem("clear-all",this.clearAllButton)}onActivateRequest(e){this.node.contains(document.activeElement)||this.collapseAllButton.node.focus()}get model(){return this._model}}var k;!function(e){e.newSpy="kernelspy:new"}(k||(k={}));const j=new c.Token("jupyter.extensions.kernelspy"),C=new m.AttachedProperty({create:()=>"",name:"SpyTarget"});class E{constructor(e){this.commands=e}createNew(e,t){let n=[],r=-1;(0,i.find)(e.toolbar.children(),(e,t)=>!!e.hasClass("jp-Notebook-toolbarCellType")&&(r=t,!0));let s=1;for(let t of[k.newSpy]){let a=new o.CommandToolbarButton({id:t,commands:this.commands});a.addClass("jp-kernelspy-nbtoolbarbutton"),r>=0?e.toolbar.insertItem(r+s++,this.commands.label(t),a):e.toolbar.addItem(this.commands.label(t),a),n.push(a)}return new u.DisposableDelegate(()=>{for(let e of n)e.dispose()})}}const w={id:"jupyterlab-kernelspy",autoStart:!0,requires:[d.INotebookTracker],optional:[o.ICommandPalette,l.IMainMenu,s.ILayoutRestorer],provides:j,activate:async(e,t,n,r,s)=>{let{commands:a,docRegistry:l}=e,i=new E(a);l.addWidgetExtension("Notebook",i);const d=new o.WidgetTracker({namespace:"kernelspy"});function c(){a.notifyCommandChanged(k.newSpy)}s&&s.restore(d,{command:k.newSpy,args:e=>({path:C.get(e.content),activate:!1}),name:e=>C.get(e.content),when:t.restored}),function(e,t,n,r,s){const{commands:a,shell:l}=e;a.addCommand(k.newSpy,{label:"New kernel spy",caption:"Open a window to inspect messages sent to/from a kernel",iconClass:"jp-Icon jp-Icon-16 jp-kernelspyIcon",isEnabled:function(){var e,n,r;return null!==t.currentWidget&&null!==(null!==(r=null===(n=null===(e=t.currentWidget.context.sessionContext)||void 0===e?void 0:e.session)||void 0===n?void 0:n.kernel)&&void 0!==r?r:null)},execute:e=>{var r,s,a;let i;if(i=e.path?null!==(r=t.find(t=>t.context.path===e.path))&&void 0!==r?r:null:t.currentWidget,!i)return;const d=new b(null===(a=null===(s=i.context.sessionContext)||void 0===s?void 0:s.session)||void 0===a?void 0:a.kernel);d.title.label="Kernel spy: "+i.title.label,i.title.changed.connect(()=>{d.title.label="Kernel spy: "+i.title.label});const c=new o.MainAreaWidget({content:d});C.set(d,i.context.path),i.context.pathChanged.connect((e,t)=>{C.set(d,t),n.save(c)}),n.add(c),i.context.sessionContext.kernelChanged.connect((e,t)=>{d.model.kernel=t.newValue}),l.add(c,"main",{mode:"split-right"}),!1!==e.activate&&l.activateById(c.id),i.disposed.connect(()=>{c.close()})}}),null==r||r.addItem({command:k.newSpy,category:"Kernel"}),null==s||s.kernelMenu.addGroup([{command:k.newSpy}])}(e,t,d,n,r),t.currentChanged.connect(c);let p=t.currentWidget;return p&&p.context.sessionContext.kernelChanged.connect(c),t.currentChanged.connect(e=>{p&&p.context.sessionContext.kernelChanged.disconnect(c),p=e.currentWidget,p&&p.context.sessionContext.kernelChanged.connect(c)}),i}}},760:(e,t,n)=>{(e.exports=n(645)(!1)).push([e.id,"\r\n\r\n.jp-kernelspy-view .jp-kernelspy-toolbar {\r\n  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);\r\n  padding: 2px;\r\n  min-height: var(--jp-private-notebook-panel-toolbar-height);\r\n  box-shadow: var(--jp-toolbar-box-shadow);\r\n  background: var(--jp-toolbar-background);\r\n  z-index: 1;\r\n}\r\n\r\n.jp-kernelspy-view .jp-kernelspy-messagelog {\r\n  padding: 8px;\r\n  overflow: auto;\r\n  white-space: nowrap;\r\n  font-family: var(--jp-code-font-family);\r\n  font-size: var(--jp-code-font-size);\r\n  line-height: var(--jp-code-line-height);\r\n  color: var(--jp-content-font-color1);\r\n  background-color: var(--jp-layout-color0);\r\n  display: grid;\r\n  grid-template-columns: max-content auto;\r\n  grid-column-gap: 12px;\r\n  grid-row-gap: 2px;\r\n  align-content: start;\r\n}\r\n\r\n.jp-kernelspy-view .jp-kernelspy-logheader {\r\n  font-family: var(--jp-ui-font-family);\r\n  font-size: var(--jp-ui-font-size1);\r\n  line-height: 1;\r\n}\r\n\r\n.jp-kernelspy-view .jp-kernelspy-divider {\r\n  grid-column-end: span 2;\r\n  border-bottom: var(--jp-border-width) solid var(--jp-border-color2);\r\n  padding-top: 2px;\r\n  margin-bottom: 3px;\r\n}\r\n\r\n.jp-kernelspy-view .jp-kernelspy-divider.jp-kernelspy-logheader {\r\n  border-bottom: var(--jp-border-width) solid var(--jp-border-color0);\r\n}\r\n\r\nbutton.jp-kernelspy-threadcollapser {\r\n  background-color: transparent;\r\n  border: none;\r\n}\r\n\r\n.jp-kernelspyIcon {\r\n  background-image: var(--jp-icon-json);\r\n}\r\n\r\n.jp-kernelspy-nbtoolbarbutton .jp-ToolbarButtonComponent-label {\r\n  display: none;\r\n}\r\n\r\n.kspy-collapser-icon {\r\n  padding: 0;\r\n}\r\n\r\n.kspy-collapser-icon svg {\r\n  vertical-align: middle;\r\n}\r\n",""])},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,r,o,s=e[1]||"",a=e[3];if(!a)return s;if(t&&"function"==typeof btoa){var l=(n=a,r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),"/*# ".concat(o," */")),i=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot).concat(e," */")}));return[s].concat(i).concat([l]).join("\n")}return[s].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(n,"}"):n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var s=this[o][0];null!=s&&(r[s]=!0)}for(var a=0;a<e.length;a++){var l=e[a];null!=l[0]&&r[l[0]]||(n&&!l[2]?l[2]=n:n&&(l[2]="(".concat(l[2],") and (").concat(n,")")),t.push(l))}},t}},549:(e,t,n)=>{var r=n(379),o=n(760);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.id,o,""]]);r(o,{insert:"head",singleton:!1}),e.exports=o.locals||{}},379:(e,t,n)=>{"use strict";var r,o=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),s=[];function a(e){for(var t=-1,n=0;n<s.length;n++)if(s[n].identifier===e){t=n;break}return t}function l(e,t){for(var n={},r=[],o=0;o<e.length;o++){var l=e[o],i=t.base?l[0]+t.base:l[0],d=n[i]||0,c="".concat(i," ").concat(d);n[i]=d+1;var p=a(c),h={css:l[1],media:l[2],sourceMap:l[3]};-1!==p?(s[p].references++,s[p].updater(h)):s.push({identifier:c,updater:g(h,t),references:1}),r.push(c)}return r}function i(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var s=n.nc;s&&(r.nonce=s)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var a=o(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var d,c=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function p(e,t,n,r){var o=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=c(t,o);else{var s=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(s,a[t]):e.appendChild(s)}}function h(e,t,n){var r=n.css,o=n.media,s=n.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),s&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var u=null,m=0;function g(e,t){var n,r,o;if(t.singleton){var s=m++;n=u||(u=i(t)),r=p.bind(null,n,s,!1),o=p.bind(null,n,s,!0)}else n=i(t),r=h.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var n=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var o=a(n[r]);s[o].references--}for(var i=l(e,t),d=0;d<n.length;d++){var c=a(n[d]);0===s[c].references&&(s[c].updater(),s.splice(c,1))}n=i}}}}}]);